import React, {Component} from 'react';

import FontAwesomeIcon from '@fortawesome/react-fontawesome'

import ListFile from '../ListFile';

export default class Files extends Component{
    constructor(props) {
        super(props);

        this.state = {
            token: document.head.querySelector('meta[name="csrf-token"]').content,
            login: document.head.querySelector('meta[name="basic-auth"]').content,
            files: [{"fileId":"BLnYS8RBX","nameId":"qZWrKIV4KkPDLbeeypVUhRMs7YfJzwAFfDWjNtpy","serverId":"public\/auttawir\/qZWrKIV4KkPDLbeeypVUhRMs7YfJzwAFfDWjNtpy.jpeg","filename":"msc2018.jpg","filenameWithoutExtension":"msc2018","fileType":"image\/jpeg","fileExtension":"jpg","fileSize":"1258513","fileLastModified":"1514381575695","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-26 13:46:22.987","updated_at":"2018-04-26 13:46:22.987","deleted_at":null,"mimeType":null},{"fileId":"hYsfhK1x5","nameId":"kMF6aa2Ps1Z7LsbHJNBelXT1QKiqKt9fJ8qJkVPd","serverId":"public\/auttawir\/kMF6aa2Ps1Z7LsbHJNBelXT1QKiqKt9fJ8qJkVPd.jpeg","filename":"newyear2561.jpg","filenameWithoutExtension":"newyear2561","fileType":"image\/jpeg","fileExtension":"jpg","fileSize":"1054352","fileLastModified":"1514391563822","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-26 13:46:22.987","updated_at":"2018-04-26 13:46:22.987","deleted_at":null,"mimeType":null},{"fileId":"urj3wrsx2","nameId":"UvCTseArcE4PMv0m89Q85dGX0seMiENTGfmOsAtk","serverId":"public\/auttawir\/UvCTseArcE4PMv0m89Q85dGX0seMiENTGfmOsAtk.jpeg","filename":"IMG_7357.JPG","filenameWithoutExtension":"IMG_7357","fileType":"image\/jpeg","fileExtension":"JPG","fileSize":"221729","fileLastModified":"1520571197377","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-26 13:46:22.973","updated_at":"2018-04-26 13:46:22.973","deleted_at":null,"mimeType":null},{"fileId":"lrcf3tvbr","nameId":"kMF6aa2Ps1Z7LsbHJNBelXT1QKiqKt9fJ8qJkVPd","serverId":"public\/auttawir\/kMF6aa2Ps1Z7LsbHJNBelXT1QKiqKt9fJ8qJkVPd.jpeg","filename":"newyear2561.jpg","filenameWithoutExtension":"newyear2561","fileType":"image\/jpeg","fileExtension":"jpg","fileSize":"1054352","fileLastModified":"1514391563822","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-26 13:45:37.057","updated_at":"2018-04-26 13:45:37.057","deleted_at":null,"mimeType":null},{"fileId":"wshmou96l","nameId":"qZWrKIV4KkPDLbeeypVUhRMs7YfJzwAFfDWjNtpy","serverId":"public\/auttawir\/qZWrKIV4KkPDLbeeypVUhRMs7YfJzwAFfDWjNtpy.jpeg","filename":"msc2018.jpg","filenameWithoutExtension":"msc2018","fileType":"image\/jpeg","fileExtension":"jpg","fileSize":"1258513","fileLastModified":"1514381575695","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-26 13:45:37.037","updated_at":"2018-04-26 13:45:37.037","deleted_at":null,"mimeType":null},{"fileId":"gvd3ac4rx","nameId":"NVisD8DLI5iX4uPffJtI7arGaKKcsXNDua3i6N2q","serverId":"public\/auttawir\/NVisD8DLI5iX4uPffJtI7arGaKKcsXNDua3i6N2q.jpeg","filename":"erik-jan-leusink-326914-unsplash.jpeg","filenameWithoutExtension":"erik-jan-leusink-326914-unsplash","fileType":"image\/jpeg","fileExtension":"jpeg","fileSize":"1769299","fileLastModified":"1522827738831","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-26 07:50:02.097","updated_at":"2018-04-26 07:50:02.097","deleted_at":null,"mimeType":null},{"fileId":"ubb2e4kft","nameId":"9Ueic7U3IW4mpmecVSxbcmyh99sCC6aceDtCCLDF","serverId":"public\/auttawir\/9Ueic7U3IW4mpmecVSxbcmyh99sCC6aceDtCCLDF.png","filename":"isa9scnbp.png","filenameWithoutExtension":"isa9scnbp","fileType":"image\/png","fileExtension":"png","fileSize":"9981","fileLastModified":"1524470230201","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-26 07:50:02.090","updated_at":"2018-04-26 07:50:02.090","deleted_at":null,"mimeType":null},{"fileId":"jrxn2infz","nameId":"YxasF1F3RFINmIj04JCRQoPBuUpVBnXYZe5VJ5Rc","serverId":"public\/auttawir\/YxasF1F3RFINmIj04JCRQoPBuUpVBnXYZe5VJ5Rc.png","filename":"liegsqkwf.png","filenameWithoutExtension":"liegsqkwf","fileType":"image\/png","fileExtension":"png","fileSize":"9977","fileLastModified":"1524647419225","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-26 07:50:02.077","updated_at":"2018-04-26 07:50:02.077","deleted_at":null,"mimeType":null},{"fileId":"liegsqkwf","nameId":"LpkQMAaiikpDu84eUp29Objzh55dq3xG87bdZ7rG","serverId":"public\/auttawir\/LpkQMAaiikpDu84eUp29Objzh55dq3xG87bdZ7rG.pdf","filename":"b4kdil9aj.pdf","filenameWithoutExtension":"b4kdil9aj","fileType":"application\/pdf","fileExtension":"pdf","fileSize":"433994","fileLastModified":"1524473465967","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-25 01:43:18.287","updated_at":"2018-04-25 01:43:18.287","deleted_at":null,"mimeType":null},{"fileId":"0agd0ujja","nameId":"OE73UtuiZ30VrGjj6fhCTWxKPBFXcNAaLBL6EVn9","serverId":"public\/auttawir\/OE73UtuiZ30VrGjj6fhCTWxKPBFXcNAaLBL6EVn9.pdf","filename":"pdf.pdf","filenameWithoutExtension":"pdf","fileType":"application\/pdf","fileExtension":"pdf","fileSize":"433994","fileLastModified":"1524127836369","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-25 01:43:18.283","updated_at":"2018-04-25 01:43:18.283","deleted_at":null,"mimeType":null},{"fileId":"l92uwkin1","nameId":"5r7QLFd1dBIF9cThxjKCK3VmorIteArAn7e3mW62","serverId":"public\/auttawir\/5r7QLFd1dBIF9cThxjKCK3VmorIteArAn7e3mW62.png","filename":"7770535422163.jpg","filenameWithoutExtension":"7770535422163","fileType":"image\/jpeg","fileExtension":"jpg","fileSize":"59780","fileLastModified":"1523346301436","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-25 01:43:18.280","updated_at":"2018-04-25 01:43:18.280","deleted_at":null,"mimeType":null},{"fileId":"e9yipnu29","nameId":"OtbcLIYKARgVAgq5VkZjYW9BbKIz4k1LdHZRxiqP","serverId":"public\/auttawir\/OtbcLIYKARgVAgq5VkZjYW9BbKIz4k1LdHZRxiqP.jpeg","filename":"p9u1n91kb.jpg","filenameWithoutExtension":"p9u1n91kb","fileType":"image\/jpeg","fileExtension":"jpg","fileSize":"6870657","fileLastModified":"1524473474219","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-25 01:43:18.277","updated_at":"2018-04-25 01:43:18.277","deleted_at":null,"mimeType":null},{"fileId":"bynfhz3la","nameId":"AsSJcSD6pKjr2bH0WsGhpXJdFsylzzWrWhvFSIoM","serverId":"public\/auttawir\/AsSJcSD6pKjr2bH0WsGhpXJdFsylzzWrWhvFSIoM.png","filename":"logo.png","filenameWithoutExtension":"logo","fileType":"image\/png","fileExtension":"png","fileSize":"18750","fileLastModified":"1524476163848","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-25 01:43:18.267","updated_at":"2018-04-25 01:43:18.267","deleted_at":null,"mimeType":null},{"fileId":"yj6tw7axk","nameId":"Q7RIvcAECeMyWwVUrdLIMj49a8WNBWWicUadfIu1","serverId":"public\/auttawir\/Q7RIvcAECeMyWwVUrdLIMj49a8WNBWWicUadfIu1.jpeg","filename":"erik-jan-leusink-326914-unsplash.jpeg","filenameWithoutExtension":"erik-jan-leusink-326914-unsplash","fileType":"image\/jpeg","fileExtension":"jpeg","fileSize":"1769299","fileLastModified":"1522827738831","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-25 01:43:18.263","updated_at":"2018-04-25 01:43:18.263","deleted_at":null,"mimeType":null},{"fileId":"ughbjl3i8","nameId":"0Q9C98cC8a65ymmED6VgjqMtzCK54vLMQ6v3GxX7","serverId":"public\/auttawir\/0Q9C98cC8a65ymmED6VgjqMtzCK54vLMQ6v3GxX7.png","filename":"bc66a95b2.png","filenameWithoutExtension":"bc66a95b2","fileType":"image\/png","fileExtension":"png","fileSize":"10044","fileLastModified":"1524544390033","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-25 01:43:18.260","updated_at":"2018-04-25 01:43:18.260","deleted_at":null,"mimeType":null},{"fileId":"j6y9vlkrs","nameId":"eCXbDio6xYUultpI6GhbFjqa0LH6ChtkKVmFf9nS","serverId":"public\/auttawir\/eCXbDio6xYUultpI6GhbFjqa0LH6ChtkKVmFf9nS.png","filename":"isa9scnbp.png","filenameWithoutExtension":"isa9scnbp","fileType":"image\/png","fileExtension":"png","fileSize":"9981","fileLastModified":"1524470230201","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-25 01:43:18.257","updated_at":"2018-04-25 01:43:18.257","deleted_at":null,"mimeType":null},{"fileId":"gc0nmwmld","nameId":"jKUFBDIcEwpDlXqmdZ37yi4oJpBXW1FeFNSPXHkM","serverId":"public\/auttawir\/jKUFBDIcEwpDlXqmdZ37yi4oJpBXW1FeFNSPXHkM.png","filename":"b4kdil9aj.png","filenameWithoutExtension":"b4kdil9aj","fileType":"image\/png","fileExtension":"png","fileSize":"10025","fileLastModified":"1524553730952","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-25 01:43:18.253","updated_at":"2018-04-25 01:43:18.253","deleted_at":null,"mimeType":null},{"fileId":"f7gu6hoed","nameId":"0KNF6fd4BgN6ilwHeXwBq03BAADuYna5YqBBWrVP","serverId":"public\/auttawir\/0KNF6fd4BgN6ilwHeXwBq03BAADuYna5YqBBWrVP.png","filename":"logo.png","filenameWithoutExtension":"logo","fileType":"image\/png","fileExtension":"png","fileSize":"18750","fileLastModified":"1524476163848","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-24 11:10:22.677","updated_at":"2018-04-24 11:10:22.677","deleted_at":null,"mimeType":null},{"fileId":"9e2ft69f2","nameId":"QG9u3GLkuuw8WDtvdm1eBJSzrXVqQu4xI1MkWDcG","serverId":"public\/auttawir\/QG9u3GLkuuw8WDtvdm1eBJSzrXVqQu4xI1MkWDcG.jpeg","filename":"steve-bittinger-305735-unsplash.jpg","filenameWithoutExtension":"steve-bittinger-305735-unsplash","fileType":"image\/jpeg","fileExtension":"jpg","fileSize":"6870657","fileLastModified":"1524472886627","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-24 11:10:22.673","updated_at":"2018-04-24 11:10:22.673","deleted_at":null,"mimeType":null},{"fileId":"dn60fzx6b","nameId":"L8gzSI7uAcFmp5TKP1xu6AMDoNNExDyCTOdDM3WB","serverId":"public\/auttawir\/L8gzSI7uAcFmp5TKP1xu6AMDoNNExDyCTOdDM3WB.jpeg","filename":"erik-jan-leusink-326914-unsplash.jpeg","filenameWithoutExtension":"erik-jan-leusink-326914-unsplash","fileType":"image\/jpeg","fileExtension":"jpeg","fileSize":"1769299","fileLastModified":"1522827738831","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-24 11:10:22.670","updated_at":"2018-04-24 11:10:22.670","deleted_at":null,"mimeType":null},{"fileId":"b7cejn8cp","nameId":"6vOu6ajr1eQRDQOI2sAg6bCdZgizjxdAcBwfcrid","serverId":"public\/auttawir\/6vOu6ajr1eQRDQOI2sAg6bCdZgizjxdAcBwfcrid.png","filename":"7770535422163.jpg","filenameWithoutExtension":"7770535422163","fileType":"image\/jpeg","fileExtension":"jpg","fileSize":"59780","fileLastModified":"1523346301436","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-24 11:10:22.660","updated_at":"2018-04-24 11:10:22.660","deleted_at":null,"mimeType":null},{"fileId":"ok2ccnla0","nameId":"g5rZkcWpaD3Jlfvxl9vn75eREokYouPsGQywmt3v","serverId":"public\/auttawir\/g5rZkcWpaD3Jlfvxl9vn75eREokYouPsGQywmt3v.jpeg","filename":"erik-jan-leusink-326914-unsplash.jpeg","filenameWithoutExtension":"erik-jan-leusink-326914-unsplash","fileType":"image\/jpeg","fileExtension":"jpeg","fileSize":"1769299","fileLastModified":"1522827738831","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-24 11:10:03.593","updated_at":"2018-04-24 11:10:03.593","deleted_at":null,"mimeType":null},{"fileId":"072ze7umi","nameId":"EIeruAcNwhiQRIGTE9My3s13TtnMAsBbSaXEQuiX","serverId":"public\/auttawir\/EIeruAcNwhiQRIGTE9My3s13TtnMAsBbSaXEQuiX.jpeg","filename":"p9u1n91kb.jpg","filenameWithoutExtension":"p9u1n91kb","fileType":"image\/jpeg","fileExtension":"jpg","fileSize":"6870657","fileLastModified":"1524473474219","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-24 11:10:03.590","updated_at":"2018-04-24 11:10:03.590","deleted_at":null,"mimeType":null},{"fileId":"3sgec1cot","nameId":"r3LUIVfMnTWBbmR8hQqnXALzToL29eXx7jFSZGG9","serverId":"public\/auttawir\/r3LUIVfMnTWBbmR8hQqnXALzToL29eXx7jFSZGG9.png","filename":"7770535422163.jpg","filenameWithoutExtension":"7770535422163","fileType":"image\/jpeg","fileExtension":"jpg","fileSize":"59780","fileLastModified":"1523346301436","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-24 11:10:03.587","updated_at":"2018-04-24 11:10:03.587","deleted_at":null,"mimeType":null},{"fileId":"3xrrfardt","nameId":"4FJ1EEExePwwI55OGsGp0WQPmIQgEOBi3Gj80GLC","serverId":"public\/auttawir\/4FJ1EEExePwwI55OGsGp0WQPmIQgEOBi3Gj80GLC.png","filename":"logo.png","filenameWithoutExtension":"logo","fileType":"image\/png","fileExtension":"png","fileSize":"18750","fileLastModified":"1524476163848","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-24 11:10:03.577","updated_at":"2018-04-24 11:10:03.577","deleted_at":null,"mimeType":null},{"fileId":"b4kdil9aj","nameId":"2EcvYwjTdt91iE6ZXDaG8sMj6bzZ2Mxwo3SiBAlo","serverId":"public\/auttawir\/2EcvYwjTdt91iE6ZXDaG8sMj6bzZ2Mxwo3SiBAlo.pdf","filename":"pdf.pdf","filenameWithoutExtension":"pdf","fileType":"application\/pdf","fileExtension":"pdf","fileSize":"433994","fileLastModified":"1524127836369","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-23 08:21:34.160","updated_at":"2018-04-23 08:21:34.160","deleted_at":null,"mimeType":null},{"fileId":"bc66a95b2","nameId":"Dyw0hn3txiXV19UV3eTvYDAdcLhC4RBf5iRgPre6","serverId":"public\/auttawir\/Dyw0hn3txiXV19UV3eTvYDAdcLhC4RBf5iRgPre6.mp4","filename":"Final Destination 5 Gymnastics Accident (1).mp4","filenameWithoutExtension":"Final Destination 5 Gymnastics Accident (1)","fileType":"video\/mp4","fileExtension":"mp4","fileSize":"1077016","fileLastModified":"1524469513588","isShare":"0","shareId":null,"shareLink":null,"loginUser":"auttawir","created_at":"2018-04-23 08:21:34.130","updated_at":"2018-04-23 08:21:34.130","deleted_at":null,"mimeType":null}],
            finishLoading: true
        };

        this.removeFile = this.removeFile.bind(this);
    }

    removeFile(id) {
        Swal({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            type: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.value) {
                let login = this.state.login;
                axios.post('api/file/delete', {id, login}).then((response) => {
                if(response.status === 200){
                        let files = this.state.files;
                        files = files.filter((el) => (
                            el.fileId != id
                        ))
                        this.setState({files})
                        Swal(
                            'Deleted!',
                            'Your file has been deleted.',
                            'success'
                        )
                    }          
                }).catch(function (error) {
                    Swal('ไม่สามารถลบรูปได้', 'กรุณาติดต่อผู้ดูแลระบบได้ที่เบอร์ 78452', 'error')
                });
            }
        })
    }

    componentDidMount() {
        axios.get('api/file/' + this.state.login).then((response) => {
            if(response.status === 200){
                console.log(response)
                this.setState({files: response.data, finishLoading: true})                                
            }
        }).catch(function (error) {
            Swal('ไม่สามารถดึงข้อมูลได้', 'กรุณาติดต่อผู้ดูแลระบบได้ที่เบอร์ 78452', 'error')
            console.log(error)
        });
    }

    render(){
        return(
            <div className="d-flex h-100 pl-5 pt-4 mt-3">
                {
                    (this.state.finishLoading) ? 
                        <ListFile files={this.state.files} shareSettingBtn={true} removeFile={this.removeFile}/> 
                    :
                        <div className="d-flex flex-column align-self-center p-3">
                            <h1>Loading <FontAwesomeIcon icon={["fas", "sync"]} spin className="ml-1"/></h1>
                        </div>
                }
                
            </div>
        )
    }
}